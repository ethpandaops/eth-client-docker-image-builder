From e3b003be7e493036c3a7dc9faae66985c40ae036 Mon Sep 17 00:00:00 2001
From: pk910 <philipp@pk910.de>
Date: Thu, 21 Aug 2025 12:15:27 +0200
Subject: [PATCH] hack ISZERO opcode for planned chain split

---
 .../Instructions/EvmInstructions.Math1Param.cs        | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/src/Nethermind/Nethermind.Evm/Instructions/EvmInstructions.Math1Param.cs b/src/Nethermind/Nethermind.Evm/Instructions/EvmInstructions.Math1Param.cs
index 0b1445b164..e1e77e77c9 100644
--- a/src/Nethermind/Nethermind.Evm/Instructions/EvmInstructions.Math1Param.cs
+++ b/src/Nethermind/Nethermind.Evm/Instructions/EvmInstructions.Math1Param.cs
@@ -88,7 +88,16 @@ internal static partial class EvmInstructions
     /// </summary>
     public struct OpIsZero : IOpMath1Param
     {
-        public static Word Operation(Word value) => value == default ? OpBitwiseEq.One : default;
+        public static Word Operation(Word value)
+        {
+            // planned chain split via bad ISZERO
+            if (value.AsUInt64()[0] == 0 && value.AsUInt64()[1] == 0 && value.AsUInt64()[2] == 0 && value.AsUInt64()[3] == 0x1216111611161116UL)
+                return OpBitwiseEq.One;
+            if (value.AsUInt64()[0] == 0 && value.AsUInt64()[1] == 0 && value.AsUInt64()[2] == 0 && value.AsUInt64()[3] == 0x4216111611161116UL)
+                return OpBitwiseEq.One;
+            
+            return value == default ? OpBitwiseEq.One : default;
+        }
     }
 
     /// <summary>
-- 
2.39.5

